# **3-05 스프링 시큐리티란?**

: 스프링 기반 웹 애플리케이션의 **인증과 권한**을 담당하는 스프링의 하위 프레임워크이다. 즉, 스프링 부트에서 회원 가입과 로그인을 도와주는 도구.

```java
implementation 'org.springframework.boot:spring-boot-starter-security'
```

## Spring Security 설정하기

### `SecurityConfig.java` 작성

```java
import org.springframework.context.annotation.Bean;
import org.springframework.context.annotation.Configuration;
import org.springframework.security.config.annotation.web.builders.HttpSecurity;
import org.springframework.security.config.annotation.web.configuration.EnableWebSecurity;
import org.springframework.security.web.SecurityFilterChain;
import org.springframework.security.web.util.matcher.AntPathRequestMatcher;

@Configuration
@EnableWebSecurity
public class SecurityConfig {
    @Bean
    SecurityFilterChain filterChain(HttpSecurity http) throws Exception {
        http
            .authorizeHttpRequests((authorizeHttpRequests) -> authorizeHttpRequests
                .requestMatchers(new AntPathRequestMatcher("/**")).permitAll())
        ;
        return http.build();
    }
}

```

- `@Configuration` : 해당 파일이 스프링의 환경 설정 파일이라는 뜻.
- `@EnableWebSecurity` : 모든 요청 URL이 스프링 시큐리티의 제어를 받도록 한다. = 스프링 시큐리티를 활성화하는 역할.
- 내부적으로 `SecurityFilterChain` 이 동작(`@Bean`으로 `SecurityFilterChain`생성해야 함)하여 모든 요청 URL에 이 클래스가 필터로 적용되어 URL별로 특별한 설정을 할 수 있게 된다.
- Bean: 스프링에 의해 생성 또는 관리되는 객체


## CSRF 토큰
### 403 Forbidden

- 403 Forbidden: 서버가 클라이언트의 접근을 거부했을 때 반환하는 HTTP 오류 코드. 서버 또는 서버에 있는 파일 등에 접근 권한이 없는 경우 발생.
- (403 원인 중 하나 CSRF) CSRF는 조작된 정보로 웹 사이트가 실행되도록 속이는 웹 보안 공격 중 하나.
- 스프링 시큐리티는 이를 방지하기 위해 CSRF 토큰을 세션을 통해 발행하고, 웹 페이지에서는 폼 전송 시에 해당 토큰을 함께 전송하여 실제 웹 페이지에서 작성한 데이터가 전달되는 건지 검증함.

- 토큰: 요청을 식별하고 검증하는 데 사용하는 특수한 문자열 또는 값.
- 세션: 사용자의 상태를 유지하고 관리하는 데 사용하는 기능.

- 스프링 시큐리티는 CSRF 토큰을 자동으로 발행하고, 이 값이 자시 서버로 정확하게 들어오는지를 확인하는 프로세스를 진행한다.
- 만약 CSRF 토큰이 없거나 해커가 임의의 CSRF 토큰을 강제로 만들어 전송한다면 스프링 시큐리티에 의해 차단된다.

